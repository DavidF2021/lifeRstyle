---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"   
)
```

# lifeRstyle

<!-- badges: start -->
<!-- badges: end -->

## Description

**lifeRstyle** is an R package designed to download, clean, and analyse
Irish lifestyle and health data from the Central Statistics Office (CSO).
The package focuses on indicators such as:

Smoking habits

Alcohol consumption

General health and wellbeing

It provides a tidy, user-friendly workflow for loading data, visualising trends,
and fitting statistical models.

Three core functions are provided:

1. `Load_LifeRStyle()` – for downloading and preparing CSO lifestyle data.

2. A `plot()` function – for producing visualisations using `ggplot2`.

3. A `fit()` method – for fitting statistical models (linear regression, ANOVA, mixed-effects models) to said data. 

Typically, these functions are applied sequentially.
A demonstration of the typical workflow is shown below.


## Installation

You can install the development version of lifeRstyle from [GitHub](https://github.com/) with:

``` {r, eval=FALSE}
# install.packages("pak")
pak::pak("DavidF2021/lifeRstyle")

```
## Example

We are showing how to load lifestyle data and perform a simple analysis:

```{r}
library(lifeRstyle)

data <- lifeRstyle::combined_cleaned
```

Histogram of Combined Tables.

This histogram shows the distribution of Age values in the combined dataset, separated into three panels for alcohol, health, and smoking. Each bar represents how many observations fall into an age range within that table. It helps compare whether the age coverage is similar or different across the three datasets. The alcohol and smoking tables appear more concentrated in certain age ranges, while health shows a wider spread. Overall, it summarises the age structure of the combined data by table type.

Boxplot of Values by Age.

This boxplot compares the Age distribution across alcohol, health, and smoking using summary statistics rather than individual points. The median line shows the typical age in each table, and the box shows the middle 50% of ages (IQR). The whiskers extend to the main range of the data, while dots represent outliers. It highlights that the health table has a much wider age range than the others. This plot is useful for quickly spotting differences in spread and unusual age values between tables.


Scatter of Age by Table with Mean Line

This scatter plot shows individual observations of Age grouped by table (alcohol, health, smoking) along the x-axis. Each point represents one record, and the colour scale reflects the Value column, allowing patterns between age and value to be seen. The clustering of points indicates which age ranges dominate each table and where the data is concentrated. The mean line provides a reference for the average trend within each table group. Overall, it gives a detailed view of variability and how values change across ages in the combined dataset.


```{r, warning = FALSE, message = FALSE}
plot_combined_data(data)

```

This output shows the results of a linear regression model fitted as value ~ Sex + Age.Group + Year.
The residual summary (Min, 1Q, Median, 3Q, Max) describes how far the predicted values are from the observed values.
The coefficients table gives the estimated effect of each Sex and Age.Group category (relative to a reference group), plus the effect of Year.
Most predictors have high p-values, meaning there is no strong evidence that Sex, Age.Group, or Year significantly explain variation in value in this dataset.
The very low R-squared (0.00185) and non-significant F-test p-value (0.9443) indicate the model fits poorly and explains almost none of the variability in value.

```{r lm}
model <- fit_lifeRstyle(data, fit_type = "lm")
summary(model) 

```

This output is a one-way ANOVA testing whether the mean value differs across Age.Group categories.
The table splits total variation into between-group variation (Age.Group) and within-group variation (Residuals).
The F value (0.562) is small, meaning Age.Group does not explain much variation compared to random noise.
The p-value (0.885) is very large, so there is no evidence of a significant difference in mean value across age groups.
Overall, Age.Group alone is not a strong predictor of value in this dataset.

```{r anova}
model_anova <- fit_lifeRstyle(data, fit_type = "anova")
summary(model_anova)
```

This mixed-effects model explains value using Sex and Age.Group, while allowing the baseline level to vary by table_name through a random intercept.
The random effects show noticeable differences between the three tables (SD ≈ 11.32), with larger unexplained variation at the observation level (residual SD ≈ 26.32).
Most fixed-effect estimates for Sex and Age.Group are small relative to their standard errors, suggesting weak evidence of strong effects in this model.
The intercept (30.81754) represents the expected value for the reference Sex and Age.Group level, after accounting for table-level differences.
Overall, the model suggests that table-to-table variation is more important than differences across Sex or Age.Group for predicting value.

```{r mixed}
model_mixed <- fit_lifeRstyle(data, fit_type = "mixed")
summary(model_mixed)

```
